# BookCraft 사용자 매뉴얼

## 📚 프로젝트 개요

BookCraft는 아이들의 독서 습관 형성을 돕는 게임화된 독서 플랫폼입니다. 독서를 재미있는 게임처럼 만들어 지속적인 독서 습관을 기를 수 있도록 설계되었습니다.

### 🎯 주요 특징
- **게임화된 독서 경험**: XP, 레벨, 배지, 퀘스트 시스템
- **실시간 독서 추적**: 독서 시간, 집중도, 진행률 모니터링
- **개인화된 책 관리**: ISBN 검색, 개인 책장, 독서 기록
- **가족 친화적**: 어린이와 부모 모두 사용 가능한 인터페이스

---

## 🗂️ 메뉴 구조 및 기능 설명

### 1. 🏠 **홈페이지** (`/`)

#### 📋 기능 개요
- BookCraft 소개 및 주요 기능 안내
- 회원가입/로그인 유도
- 서비스 특징 및 사용법 설명

#### 🎨 주요 구성 요소
- **Hero Section**: 메인 슬로건 "책을 읽고, 나만의 세상을 만들자!"
- **기능 소개**: 6가지 핵심 기능 카드
  - 일일 퀘스트
  - 레벨 & 배지
  - 가족 챌린지
  - 아바타 꾸미기
  - AI 독서 도우미
  - 독서 기록
- **사용법 안내**: 3단계 간단 가이드
- **CTA 섹션**: 회원가입 유도

#### 🔗 주요 액션
- `모험 시작하기` → 회원가입 페이지로 이동
- `로그인` → 로그인 페이지로 이동

---

### 2. 🔐 **인증 시스템**

#### 2.1 📝 **회원가입** (`/auth/signup`)

##### 📋 기능 개요
- 새 사용자 계정 생성
- 역할 기반 회원가입 (어린이/부모)
- 이메일 중복 확인

##### 🎨 입력 필드
- **이메일**: 고유 식별자
- **비밀번호**: 8자 이상, 보안 강화
- **이름**: 사용자 표시명
- **역할**: 어린이 또는 부모 선택

##### 🔗 API 연동
- `POST /api/auth/signup`
- JWT 토큰 자동 발급
- 회원가입 성공 시 대시보드로 리다이렉트

#### 2.2 🔑 **로그인** (`/auth/login`)

##### 📋 기능 개요
- 기존 사용자 인증
- JWT 토큰 기반 세션 관리
- 자동 로그인 유지

##### 🎨 입력 필드
- **이메일**: 등록된 이메일 주소
- **비밀번호**: 계정 비밀번호

##### 🔗 API 연동
- `POST /api/auth/login`
- 토큰 localStorage 저장
- 로그인 성공 시 대시보드로 리다이렉트

---

### 3. 📊 **대시보드** (`/dashboard`)

#### 📋 기능 개요
- 사용자 독서 현황 한눈에 보기
- 주요 통계 및 진행률 표시
- 빠른 액션 버튼 제공

#### 🎨 주요 구성 요소

##### 📈 **통계 카드 (4개)**
1. **읽은 책 수**
   - 아이콘: 📚
   - 색상: 파란색
   - 설명: "지금까지 완독한 책의 총 개수"

2. **독서 시간**
   - 아이콘: ⏰
   - 색상: 초록색
   - 설명: "총 독서에 투자한 시간 (시간)"

3. **획득 XP**
   - 아이콘: ⚡
   - 색상: 보라색
   - 설명: "독서 활동으로 얻은 경험치"

4. **보유 코인**
   - 아이콘: 🪙
   - 색상: 노란색
   - 설명: "아바타 꾸미기에 사용할 수 있는 코인"

##### 📋 **빠른 액션**
- **책 등록하기**: 새 책 추가
- **퀘스트 확인**: 오늘의 미션 보기
- **독서 시작**: 바로 독서 세션 시작

##### 📊 **최근 활동**
- 최근 독서 세션 기록
- 완료한 퀘스트 목록
- 획득한 배지 표시

---

### 4. 📚 **내 책장** (`/books`)

#### 📋 기능 개요
- 개인 도서 컬렉션 관리
- 책 등록, 조회, 관리
- ISBN 자동 검색 및 수동 입력 지원

#### 🎨 주요 구성 요소

##### 🔍 **ISBN 빠른 등록**
- **입력 필드**: ISBN 번호 (13자리)
- **자동 검색**: Google Books API 연동
- **정보 자동 완성**: 제목, 저자, 표지, 설명 등
- **예시**: `9788936434267`

##### ✏️ **수동 책 등록**
- **필수 정보**:
  - 제목 (필수)
  - 저자 (필수)
- **선택 정보**:
  - ISBN
  - 장르
  - 출판사
  - 출간일
  - 페이지 수
  - 표지 이미지 URL
  - 설명

##### 📖 **책 목록 표시**
- **카드 형태**: 표지, 제목, 저자, 장르
- **반응형 그리드**: 화면 크기별 최적화
- **정보 표시**:
  - 페이지 수
  - 출간년도
  - 장르 배지

#### 🔗 API 연동
- `GET /api/books`: 사용자 책 목록 조회
- `POST /api/books`: 새 책 등록
- Google Books API: ISBN 기반 책 정보 검색

---

### 5. 🎯 **퀘스트** (`/quests`)

#### 📋 기능 개요
- 일일 독서 미션 시스템
- 게임화된 목표 달성
- XP와 코인 보상 시스템

#### 🎨 주요 구성 요소

##### 📊 **사용자 통계 대시보드**
1. **레벨**: XP 기반 계산 (XP ÷ 100 + 1)
2. **총 XP**: 누적 경험치
3. **총 코인**: 보유 코인
4. **연속 일수**: 독서 스트릭

##### 📈 **오늘의 진행률**
- 완료된 퀘스트 / 전체 퀘스트
- 진행률 바 시각화
- 실시간 업데이트

##### 🎮 **퀘스트 타입**

1. **⏱️ 타이머 퀘스트** (`timer`)
   - 목표: 20분 독서
   - 보상: 난이도 × 10 XP, 난이도 × 5 코인
   - 색상: 파란색

2. **📝 요약 퀘스트** (`summary`)
   - 목표: 3문장 요약 작성
   - 보상: 난이도 × 15 XP, 난이도 × 7 코인
   - 색상: 초록색
   - 조건: 등록된 책이 있을 때만 생성

3. **🏆 챌린지 퀘스트** (`challenge`)
   - 목표: 주말 특별 미션
   - 보상: 난이도 × 25 XP, 난이도 × 12 코인
   - 색상: 보라색
   - 조건: 주말에만 생성

##### ⭐ **난이도 시스템**
- 1~5단계 별점 표시
- 사용자 레벨에 따른 자동 조정
- 높은 난이도 = 더 많은 보상

##### 🎁 **보상 시스템**
- **XP**: 레벨업에 사용
- **코인**: 아바타 아이템 구매
- **배지**: 특별 성취 달성 시

#### 🔗 API 연동
- `GET /api/quests`: 퀘스트 목록 및 사용자 통계
- `POST /api/quests/generate`: 일일 퀘스트 생성
- `POST /api/quests/[questId]/complete`: 퀘스트 완료 처리

---

### 6. ⏱️ **독서 세션** (`/reading`)

#### 📋 기능 개요
- 실시간 독서 시간 측정
- 집중도 모니터링
- 독서 진행률 추적
- 게임화된 보상 시스템

#### 🎨 주요 구성 요소

##### 📚 **책 선택 단계**
- 등록된 책 목록 표시
- 카드 형태 선택 인터페이스
- 책 정보 미리보기 (제목, 저자, 페이지 수)

##### ⏱️ **독서 세션 진행**

###### 📊 **실시간 통계 (3개 카드)**
1. **독서 시간**
   - 형식: `시:분:초` 또는 `분:초`
   - 실시간 업데이트 (1초 간격)
   - 아이콘: 🕐

2. **읽은 페이지**
   - 사용자 직접 입력
   - 숫자 입력 필드
   - 아이콘: 📄

3. **집중도**
   - 0-100% 범위
   - 실시간 모니터링
   - 색상 변화 (높음: 초록, 중간: 노랑, 낮음: 빨강)
   - 진행률 바 표시
   - 아이콘: 👁️

###### 🧠 **집중도 모니터링 시스템**
- **활동 감지**: 마우스 움직임, 키보드 입력, 클릭
- **점수 계산**:
  - 30초 이상 비활성 → 점수 감소 (-2점/5초)
  - 활발한 활동 → 점수 회복 (+1점/5초)
- **5초 주기 체크**: 정기적 집중도 평가

##### 🎮 **세션 제어**
- **일시정지**: 타이머 및 집중도 모니터링 중단
- **재개**: 이전 상태에서 계속
- **완료**: 세션 종료 및 보상 계산

##### 📝 **독서 기록**
- **읽은 페이지 수**: 숫자 입력
- **독서 요약**: 선택적 텍스트 입력
- **자동 저장**: 세션 종료 시 데이터베이스 저장

#### 🏆 **보상 계산 시스템**

##### 💎 **XP 계산 공식**
```
기본 XP = 독서 시간(분) × 2
페이지 보너스 = 읽은 페이지 × 5
집중도 보너스 = (집중도 / 100) × 기본 XP × 0.5
총 XP = 기본 XP + 페이지 보너스 + 집중도 보너스
```

##### 🪙 **코인 계산**
```
코인 = 총 XP ÷ 10 (소수점 버림)
```

##### 📈 **자동 업데이트**
- 사용자 총 XP/코인 증가
- 퀘스트 진행률 업데이트
- 연속 독서 일수 갱신
- 배지 조건 자동 확인

#### 🔗 API 연동
- `POST /api/reading/start`: 독서 세션 시작
- `POST /api/reading/[sessionId]/end`: 독서 세션 종료

---

## 🔧 기술적 구현 세부사항

### 🏗️ **아키텍처**

#### 🎨 **프론트엔드**
- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Styling**: TailwindCSS + shadcn/ui
- **State Management**: React Hooks + Context API
- **Authentication**: JWT 토큰 기반

#### 🗄️ **백엔드**
- **Database**: PostgreSQL (Docker)
- **ORM**: 직접 SQL 쿼리 (pg 라이브러리)
- **API**: Next.js API Routes
- **Authentication**: JWT + bcrypt

#### 🔐 **보안**
- **Password Hashing**: bcrypt
- **Token Management**: JWT (localStorage)
- **API Protection**: Bearer Token 인증
- **Data Validation**: 서버/클라이언트 양쪽 검증

### 📊 **데이터베이스 스키마**

#### 👤 **사용자 관리**
- `users`: 사용자 기본 정보, XP, 코인, 스트릭
- `families`: 가족 그룹 (향후 확장)

#### 📚 **책 관리**
- `books`: 책 정보 (제목, 저자, ISBN, 표지 등)
- `reading_sessions`: 독서 세션 기록

#### 🎯 **게임화**
- `quests`: 퀘스트 정보 및 진행률
- `badges`: 배지 정의
- `user_badges`: 사용자 배지 획득 기록
- `rewards`: 보상 아이템
- `user_rewards`: 사용자 보상 기록

#### 📈 **통계**
- `weekly_reports`: 주간 독서 리포트
- `avatar_items`: 아바타 아이템 (향후 확장)
- `user_avatar_items`: 사용자 아바타 (향후 확장)

### 🔄 **비즈니스 로직 함수**

#### 📊 **통계 함수**
- `get_user_reading_stats()`: 사용자 독서 통계 조회
- `get_family_ranking()`: 가족 랭킹 조회
- `generate_weekly_report()`: 주간 리포트 생성

#### 🎯 **퀘스트 함수**
- `generate_daily_quests()`: 일일 퀘스트 자동 생성
- `complete_quest()`: 퀘스트 완료 처리
- `check_and_award_badges()`: 배지 조건 확인 및 지급

#### 📈 **진행률 함수**
- `update_reading_streak()`: 연속 독서 일수 업데이트
- `get_book_recommendations()`: 책 추천 (협업 필터링)

---

## 🚀 사용자 워크플로우

### 🆕 **신규 사용자**
1. **회원가입** → 역할 선택 (어린이/부모)
2. **첫 책 등록** → ISBN 검색 또는 수동 입력
3. **퀘스트 생성** → 오늘의 미션 확인
4. **독서 시작** → 첫 독서 세션 진행
5. **보상 획득** → XP, 코인, 배지 수집

### 🔄 **일반적인 사용 패턴**
1. **로그인** → 대시보드에서 현황 확인
2. **퀘스트 확인** → 오늘의 미션 파악
3. **독서 세션** → 책 선택 후 독서 진행
4. **퀘스트 완료** → 목표 달성 및 보상 획득
5. **진행률 확인** → 통계 및 성장 추적

### 📈 **고급 사용자**
1. **연속 독서** → 스트릭 유지 및 확장
2. **배지 수집** → 다양한 성취 달성
3. **통계 분석** → 독서 패턴 파악
4. **가족 경쟁** → 가족 구성원과 순위 경쟁 (향후)

---

## 🎯 게임화 요소 상세

### ⚡ **경험치 (XP) 시스템**
- **획득 방법**:
  - 독서 시간: 분당 2 XP
  - 페이지 읽기: 페이지당 5 XP
  - 집중도 보너스: 최대 50% 추가
  - 퀘스트 완료: 10-25 XP
- **레벨 계산**: `레벨 = (총 XP ÷ 100) + 1`

### 🪙 **코인 시스템**
- **획득 방법**:
  - XP의 10% 자동 변환
  - 퀘스트 완료 보너스
- **사용 용도**: 아바타 아이템 구매 (향후)

### 🏆 **배지 시스템**
- **조건 기반 자동 지급**
- **카테고리**:
  - 독서량 기반 (책 수, 페이지 수)
  - 연속성 기반 (스트릭)
  - 퀘스트 기반 (완료 수)

### 📅 **연속 독서 일수**
- **자동 계산**: 매일 독서 시 +1
- **초기화**: 하루 건너뛰면 0으로 리셋
- **최장 기록**: 개인 최고 기록 유지

---

## 🔧 관리자 도구

### 🗄️ **데이터베이스 관리**
- `./db-utils.sh status`: 시스템 상태 확인
- `./db-utils.sh connect`: 데이터베이스 직접 접속
- `./db-utils.sh tables`: 테이블 목록 확인
- `./db-utils.sh users`: 사용자 목록 확인
- `./db-utils.sh backup`: 데이터 백업

### 🚀 **개발 환경**
- `npm run dev`: 개발 서버 시작
- `./start-postgres.sh`: PostgreSQL 컨테이너 시작
- `./setup-database.sh`: 데이터베이스 초기 설정

---

## 🐛 문제 해결

### ❌ **일반적인 오류**

#### 🔐 **인증 오류**
- **증상**: "로그인이 필요합니다" 메시지
- **해결**: 로그아웃 후 다시 로그인
- **원인**: JWT 토큰 만료 또는 손상

#### 🗄️ **데이터베이스 연결 오류**
- **증상**: "데이터베이스 연결 실패" 메시지
- **해결**: `./start-postgres.sh` 실행
- **확인**: `./db-utils.sh status`

#### 📚 **책 등록 실패**
- **증상**: ISBN 검색 결과 없음
- **해결**: 수동 입력 사용
- **원인**: Google Books API 제한 또는 ISBN 오류

### 🔧 **성능 최적화**

#### ⚡ **로딩 속도 개선**
- 이미지 최적화 (WebP 형식 권장)
- 불필요한 API 호출 최소화
- 브라우저 캐시 활용

#### 🧠 **집중도 정확도 향상**
- 정기적인 마우스 움직임
- 키보드 상호작용 유지
- 다른 탭/앱 사용 최소화

---

## 🔮 향후 개발 계획

### 🎨 **UI/UX 개선**
- 다크 모드 지원
- 애니메이션 효과 추가
- 접근성 개선

### 🤖 **AI 기능**
- 개인화된 책 추천
- 독서 패턴 분석
- AI 독서 도우미

### 👨‍👩‍👧‍👦 **가족 기능**
- 가족 그룹 관리
- 가족 챌린지
- 부모 대시보드

### 📱 **모바일 앱**
- React Native 기반
- 오프라인 독서 지원
- 푸시 알림

---

## 📞 지원 및 문의

### 🐛 **버그 신고**
- GitHub Issues 활용
- 상세한 재현 단계 포함
- 스크린샷 첨부 권장

### 💡 **기능 제안**
- 사용자 피드백 수집
- 우선순위 기반 개발
- 커뮤니티 투표 시스템

### 📚 **사용법 문의**
- 사용자 매뉴얼 참조
- FAQ 섹션 확인
- 커뮤니티 포럼 활용

---

*BookCraft와 함께 즐거운 독서 여정을 시작하세요! 📚✨*