# BookCraft ë³´ìƒ ì‹œìŠ¤í…œ ì„¤ê³„ì„œ

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ë³´ìƒ í™”í ì²´ê³„](#ë³´ìƒ-í™”í-ì²´ê³„)
3. [ë³´ìƒ ì§€ê¸‰ ë¡œì§](#ë³´ìƒ-ì§€ê¸‰-ë¡œì§)
4. [ë ˆë²¨ë§ ì‹œìŠ¤í…œ](#ë ˆë²¨ë§-ì‹œìŠ¤í…œ)
5. [ë³´ìƒ íŒ¨í„´ ë° ë°¸ëŸ°ì‹±](#ë³´ìƒ-íŒ¨í„´-ë°-ë°¸ëŸ°ì‹±)
6. [íŠ¹ë³„ ë³´ìƒ ì‹œìŠ¤í…œ](#íŠ¹ë³„-ë³´ìƒ-ì‹œìŠ¤í…œ)
7. [êµ¬í˜„ ê°€ì´ë“œ](#êµ¬í˜„-ê°€ì´ë“œ)
8. [ë°¸ëŸ°ìŠ¤ ì¡°ì • ê°€ì´ë“œ](#ë°¸ëŸ°ìŠ¤-ì¡°ì •-ê°€ì´ë“œ)

---

## ì‹œìŠ¤í…œ ê°œìš”

BookCraftì˜ ë³´ìƒ ì‹œìŠ¤í…œì€ ë…ì„œ í™œë™ì„ ê²Œì„í™”í•˜ì—¬ ì‚¬ìš©ìì˜ ì§€ì†ì ì¸ ì°¸ì—¬ë¥¼ ìœ ë„í•˜ëŠ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì„¸ ê°€ì§€ ì£¼ìš” í™”í(XP, ì½”ì¸, ë ˆë²¨)ë¥¼ í†µí•´ ì¦‰ì‹œ ë³´ìƒê³¼ ì¥ê¸°ì  ì„±ì¥ì„ ë™ì‹œì— ì œê³µí•©ë‹ˆë‹¤.

### ğŸ¯ ì„¤ê³„ ëª©í‘œ

- **ì¦‰ì‹œ ë§Œì¡±**: ëª¨ë“  ë…ì„œ í™œë™ì— ëŒ€í•œ ì¦‰ê°ì ì¸ ë³´ìƒ
- **ì¥ê¸° ë™ê¸°**: ë ˆë²¨ì—…ê³¼ ì„±ì·¨ê°ì„ í†µí•œ ì§€ì†ì  ì°¸ì—¬
- **ê°œì¸í™”**: ë‹¤ì–‘í•œ ë³´ìƒ í™œìš© ë°©ì‹ ì œê³µ
- **ê· í˜•**: ê³¼ë„í•˜ì§€ ì•Šì€ ì ì ˆí•œ ë³´ìƒ ì²´ê³„
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ ë³´ìƒ ìœ í˜• ì¶”ê°€ ê°€ëŠ¥í•œ êµ¬ì¡°

---

## ë³´ìƒ í™”í ì²´ê³„

### âš¡ XP (Experience Points)

#### ì •ì˜ ë° íŠ¹ì„±
- **ëª©ì **: ì‚¬ìš©ìì˜ ë…ì„œ ê²½í—˜ê³¼ ì‹¤ë ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ëˆ„ì  ì§€í‘œ
- **íŠ¹ì„±**: ëˆ„ì í˜•, ì†Œë¹„ ë¶ˆê°€, ë ˆë²¨ ê³„ì‚° ê¸°ì¤€
- **ë²”ìœ„**: 0 ~ ë¬´ì œí•œ
- **í‘œì‹œ**: ì •ìˆ˜í˜• (ì˜ˆ: 1,250 XP)

#### íšë“ ë°©ë²•
```
ê¸°ë³¸ ë…ì„œ í™œë™:
- í€˜ìŠ¤íŠ¸ ì™„ë£Œ: 10~100 XP (ë‚œì´ë„ë³„)
- ë…ì„œ ì„¸ì…˜: 1ë¶„ë‹¹ 1 XP (ìµœëŒ€ 120 XP/ì„¸ì…˜)
- ì±… ì™„ë…: í˜ì´ì§€ ìˆ˜ Ã— 0.5 XP
- ì²« ì±… ë“±ë¡: 50 XP (ì¼íšŒì„±)

ë³´ë„ˆìŠ¤ í™œë™:
- ì—°ì† ë…ì„œ (7ì¼): +100 XP
- ì—°ì† ë…ì„œ (30ì¼): +500 XP
- ì›”ê°„ ëª©í‘œ ë‹¬ì„±: +300 XP
- ì™„ë²½í•œ í€˜ìŠ¤íŠ¸ ì™„ë£Œ: ê¸°ë³¸ XP Ã— 1.5ë°°
```

### ğŸ’° ì½”ì¸ (Coins)

#### ì •ì˜ ë° íŠ¹ì„±
- **ëª©ì **: ê²Œì„ ë‚´ êµ¬ë§¤ ê°€ëŠ¥í•œ ê°€ìƒ í™”í
- **íŠ¹ì„±**: ì†Œë¹„í˜•, ì•„ë°”íƒ€ ê¾¸ë¯¸ê¸° ë° íŠ¹ë³„ ì•„ì´í…œ êµ¬ë§¤
- **ë²”ìœ„**: 0 ~ ë¬´ì œí•œ
- **í‘œì‹œ**: ì •ìˆ˜í˜• (ì˜ˆ: 1,250 ì½”ì¸)

#### íšë“ ë°©ë²•
```
ê¸°ë³¸ ë…ì„œ í™œë™:
- í€˜ìŠ¤íŠ¸ ì™„ë£Œ: 5~50 ì½”ì¸ (ë‚œì´ë„ë³„)
- ë…ì„œ ì„¸ì…˜: 10~30 ì½”ì¸ (ì‹œê°„ë³„)
- ì±… ì™„ë…: í˜ì´ì§€ ìˆ˜ Ã— 0.2 ì½”ì¸
- ì¼ì¼ ë¡œê·¸ì¸: 5 ì½”ì¸

ë³´ë„ˆìŠ¤ í™œë™:
- ì—°ì† ë…ì„œ ë³´ë„ˆìŠ¤: +50 ì½”ì¸
- ì£¼ê°„ ëª©í‘œ ë‹¬ì„±: +100 ì½”ì¸
- ê°€ì¡± ì±Œë¦°ì§€ ì°¸ì—¬: +75 ì½”ì¸
- íŠ¹ë³„ ì´ë²¤íŠ¸: +200 ì½”ì¸
```

#### ì†Œë¹„ ë°©ë²•
```
ì•„ë°”íƒ€ ì‹œìŠ¤í…œ:
- ê¸°ë³¸ ì•„ì´í…œ: 50~100 ì½”ì¸
- í¬ê·€ ì•„ì´í…œ: 200~500 ì½”ì¸
- ì „ì„¤ ì•„ì´í…œ: 1000+ ì½”ì¸

íŠ¹ë³„ ê¸°ëŠ¥:
- í€˜ìŠ¤íŠ¸ ìŠ¤í‚µ: 100 ì½”ì¸
- ì¶”ê°€ í€˜ìŠ¤íŠ¸ ìŠ¬ë¡¯: 200 ì½”ì¸
- íŠ¹ë³„ ë°°ì§€: 300 ì½”ì¸
```

### ğŸ† ë ˆë²¨ (Level)

#### ì •ì˜ ë° íŠ¹ì„±
- **ëª©ì **: ì‚¬ìš©ìì˜ ë…ì„œ ìˆ™ë ¨ë„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„
- **íŠ¹ì„±**: XP ê¸°ë°˜ ìë™ ê³„ì‚°, ëª…ì˜ˆ ì§€í‘œ
- **ë²”ìœ„**: 1 ~ ë¬´ì œí•œ
- **í‘œì‹œ**: ì •ìˆ˜í˜• (ì˜ˆ: ë ˆë²¨ 15)

#### ê³„ì‚° ê³µì‹
```javascript
// ê¸°ë³¸ ê³µì‹
level = Math.floor(total_xp / 100) + 1

// ì˜ˆì‹œ
0~99 XP = ë ˆë²¨ 1
100~199 XP = ë ˆë²¨ 2
1000~1099 XP = ë ˆë²¨ 11
```

#### ë ˆë²¨ë³„ í˜œíƒ
```
ë ˆë²¨ 5: íŠ¹ë³„ ë°°ì§€ "ë…ì„œ ì…ë¬¸ì" íšë“
ë ˆë²¨ 10: ì•„ë°”íƒ€ ìŠ¬ë¡¯ +1 ê°œë°©
ë ˆë²¨ 15: ì¼ì¼ í€˜ìŠ¤íŠ¸ ìŠ¬ë¡¯ +1 ê°œë°©
ë ˆë²¨ 20: íŠ¹ë³„ ë°°ì§€ "ë…ì„œ ì• í˜¸ê°€" íšë“
ë ˆë²¨ 25: ê°€ì¡± ì±Œë¦°ì§€ ìƒì„± ê¶Œí•œ
ë ˆë²¨ 30: íŠ¹ë³„ ë°°ì§€ "ë…ì„œ ë§ˆìŠ¤í„°" íšë“
```

---

## ë³´ìƒ ì§€ê¸‰ ë¡œì§

### ğŸ”„ ë™ì‹œ ì§€ê¸‰ ì‹œìŠ¤í…œ

ëª¨ë“  ë…ì„œ í™œë™ì€ XPì™€ ì½”ì¸ì„ ë™ì‹œì— ì§€ê¸‰í•˜ì—¬ ì¦‰ì‹œ ë§Œì¡±ê³¼ ì¥ê¸° ì„±ì¥ì„ ëª¨ë‘ ì œê³µí•©ë‹ˆë‹¤.

```javascript
// ë³´ìƒ ì§€ê¸‰ í•¨ìˆ˜
const giveReward = async (userId, activity) => {
  const baseReward = getBaseReward(activity)
  const multiplier = getMultiplier(userId, activity)
  
  const finalXP = Math.floor(baseReward.xp * multiplier)
  const finalCoins = Math.floor(baseReward.coins * multiplier)
  
  await updateUserStats(userId, {
    total_xp: user.total_xp + finalXP,
    total_coins: user.total_coins + finalCoins
  })
  
  // ë ˆë²¨ì—… ì²´í¬
  await checkLevelUp(userId)
  
  return { xp: finalXP, coins: finalCoins }
}
```

### ğŸ“Š ë³´ìƒ ê³„ì‚° ë¡œì§

#### 1. í€˜ìŠ¤íŠ¸ ì™„ë£Œ ë³´ìƒ

```javascript
const calculateQuestReward = (quest, completionQuality) => {
  const baseXP = quest.difficulty * 20 // ë‚œì´ë„ë³„ ê¸°ë³¸ XP
  const baseCoins = quest.difficulty * 10 // ë‚œì´ë„ë³„ ê¸°ë³¸ ì½”ì¸
  
  // ì™„ë£Œ í’ˆì§ˆì— ë”°ë¥¸ ë³´ë„ˆìŠ¤
  const qualityMultiplier = {
    'perfect': 1.5,    // ì™„ë²½ ì™„ë£Œ
    'good': 1.2,       // ìš°ìˆ˜ ì™„ë£Œ
    'normal': 1.0,     // ì¼ë°˜ ì™„ë£Œ
    'poor': 0.8        // ë¯¸í¡ ì™„ë£Œ
  }
  
  return {
    xp: Math.floor(baseXP * qualityMultiplier[completionQuality]),
    coins: Math.floor(baseCoins * qualityMultiplier[completionQuality])
  }
}
```

#### 2. ë…ì„œ ì„¸ì…˜ ë³´ìƒ

```javascript
const calculateReadingReward = (sessionData) => {
  const { duration, focusScore, pagesRead } = sessionData
  
  // ì‹œê°„ ê¸°ë°˜ XP (1ë¶„ = 1 XP, ìµœëŒ€ 120ë¶„)
  const timeXP = Math.min(duration, 120)
  
  // ì§‘ì¤‘ë„ ë³´ë„ˆìŠ¤ (70% ì´ìƒ ì‹œ ë³´ë„ˆìŠ¤)
  const focusBonus = focusScore >= 70 ? 1.2 : 1.0
  
  // í˜ì´ì§€ ê¸°ë°˜ ë³´ë„ˆìŠ¤
  const pageBonus = pagesRead * 2
  
  const totalXP = Math.floor((timeXP + pageBonus) * focusBonus)
  const totalCoins = Math.floor(totalXP * 0.4) // XPì˜ 40%
  
  return { xp: totalXP, coins: totalCoins }
}
```

#### 3. ì—°ì† ë…ì„œ ë³´ë„ˆìŠ¤

```javascript
const calculateStreakBonus = (currentStreak) => {
  const streakBonuses = {
    7: { xp: 100, coins: 50, badge: 'ì¼ì£¼ì¼ ì—°ì†' },
    14: { xp: 250, coins: 125, badge: '2ì£¼ ì—°ì†' },
    30: { xp: 500, coins: 250, badge: 'í•œ ë‹¬ ì—°ì†' },
    60: { xp: 1000, coins: 500, badge: 'ë‘ ë‹¬ ì—°ì†' },
    100: { xp: 2000, coins: 1000, badge: 'ë°±ì¼ ì—°ì†' }
  }
  
  return streakBonuses[currentStreak] || null
}
```

---

## ë ˆë²¨ë§ ì‹œìŠ¤í…œ

### ğŸ“ˆ ë ˆë²¨ ì§„í–‰ ê³¡ì„ 

```javascript
// ë ˆë²¨ë³„ í•„ìš” XP ê³„ì‚°
const getRequiredXP = (level) => {
  return (level - 1) * 100 // ì„ í˜• ì¦ê°€
}

// ë‹¤ìŒ ë ˆë²¨ê¹Œì§€ ë‚¨ì€ XP
const getXPToNextLevel = (currentXP) => {
  const currentLevel = Math.floor(currentXP / 100) + 1
  const nextLevelXP = currentLevel * 100
  return nextLevelXP - currentXP
}

// ë ˆë²¨ì—… ì²´í¬ ë° ì²˜ë¦¬
const checkLevelUp = async (userId) => {
  const user = await getUser(userId)
  const newLevel = Math.floor(user.total_xp / 100) + 1
  
  if (newLevel > user.current_level) {
    await handleLevelUp(userId, user.current_level, newLevel)
  }
}
```

### ğŸ‰ ë ˆë²¨ì—… ë³´ìƒ

```javascript
const handleLevelUp = async (userId, oldLevel, newLevel) => {
  // ê¸°ë³¸ ë ˆë²¨ì—… ë³´ìƒ
  const levelUpReward = {
    coins: newLevel * 25, // ë ˆë²¨ë‹¹ 25ì½”ì¸
    xp: 0 // ë ˆë²¨ì—… ìì²´ë¡œëŠ” XP ì§€ê¸‰ ì•ˆí•¨
  }
  
  // íŠ¹ë³„ ë ˆë²¨ ë³´ìƒ
  const specialRewards = {
    5: { badge: 'reading_beginner', coins: 100 },
    10: { badge: 'book_lover', coins: 200, avatar_slot: 1 },
    15: { badge: 'reading_enthusiast', coins: 300, quest_slot: 1 },
    20: { badge: 'book_master', coins: 500 },
    25: { badge: 'reading_legend', coins: 750, family_create: true },
    30: { badge: 'ultimate_reader', coins: 1000 }
  }
  
  await giveReward(userId, levelUpReward)
  
  if (specialRewards[newLevel]) {
    await giveSpecialReward(userId, specialRewards[newLevel])
  }
  
  await notifyLevelUp(userId, newLevel)
}
```

---

## ë³´ìƒ íŒ¨í„´ ë° ë°¸ëŸ°ì‹±

### ğŸ¯ ë‚œì´ë„ë³„ ë³´ìƒ ì²´ê³„

#### í€˜ìŠ¤íŠ¸ ë‚œì´ë„ (1-5)

```javascript
const questRewards = {
  1: { xp: 20, coins: 10, time: '10ë¶„' },   // ë§¤ìš° ì‰¬ì›€
  2: { xp: 40, coins: 20, time: '20ë¶„' },   // ì‰¬ì›€
  3: { xp: 60, coins: 30, time: '30ë¶„' },   // ë³´í†µ
  4: { xp: 80, coins: 40, time: '45ë¶„' },   // ì–´ë ¤ì›€
  5: { xp: 100, coins: 50, time: '60ë¶„' }   // ë§¤ìš° ì–´ë ¤ì›€
}
```

#### ë…ì„œ ì‹œê°„ë³„ ë³´ìƒ

```javascript
const readingTimeRewards = {
  '10min': { xp: 15, coins: 8 },
  '20min': { xp: 25, coins: 12 },
  '30min': { xp: 35, coins: 18 },
  '45min': { xp: 50, coins: 25 },
  '60min': { xp: 70, coins: 35 },
  '90min': { xp: 100, coins: 50 },
  '120min': { xp: 130, coins: 65 }
}
```

### ğŸ“Š ë³´ìƒ ë°¸ëŸ°ìŠ¤ ì§€í‘œ

#### ì¼ì¼ íšë“ ê°€ëŠ¥ ë³´ìƒ

```
ìµœì†Œ í™œë™ (30ë¶„ ë…ì„œ):
- XP: 35 XP
- ì½”ì¸: 18 ì½”ì¸
- ì˜ˆìƒ ë ˆë²¨ì—…: 3ì¼ë§ˆë‹¤

ë³´í†µ í™œë™ (60ë¶„ ë…ì„œ + í€˜ìŠ¤íŠ¸ 2ê°œ):
- XP: 190 XP
- ì½”ì¸: 95 ì½”ì¸
- ì˜ˆìƒ ë ˆë²¨ì—…: ë§¤ì¼

ìµœëŒ€ í™œë™ (120ë¶„ ë…ì„œ + í€˜ìŠ¤íŠ¸ 5ê°œ):
- XP: 430 XP
- ì½”ì¸: 215 ì½”ì¸
- ì˜ˆìƒ ë ˆë²¨ì—…: í•˜ë£¨ 4ë ˆë²¨
```

#### ê²½ì œ ë°¸ëŸ°ìŠ¤

```
ì•„ë°”íƒ€ ì•„ì´í…œ ê°€ê²© ëŒ€ë¹„ íšë“ ì‹œê°„:
- ê¸°ë³¸ ì•„ì´í…œ (50ì½”ì¸): 3ì¼ ìµœì†Œ í™œë™
- í¬ê·€ ì•„ì´í…œ (200ì½”ì¸): 2ì¼ ë³´í†µ í™œë™
- ì „ì„¤ ì•„ì´í…œ (1000ì½”ì¸): 5ì¼ ìµœëŒ€ í™œë™
```

---

## íŠ¹ë³„ ë³´ìƒ ì‹œìŠ¤í…œ

### ğŸ ì´ë²¤íŠ¸ ë³´ìƒ

#### ê³„ì ˆë³„ ì´ë²¤íŠ¸

```javascript
const seasonalEvents = {
  spring: {
    name: 'ë´„ë§ì´ ë…ì„œ ì¶•ì œ',
    duration: '3ì›” 1ì¼ ~ 3ì›” 31ì¼',
    bonus: 'XP 1.5ë°°, íŠ¹ë³„ ë°°ì§€',
    rewards: { xp_multiplier: 1.5, special_badge: 'spring_reader' }
  },
  summer: {
    name: 'ì—¬ë¦„ ë…ì„œ ìº í”„',
    duration: '7ì›” 1ì¼ ~ 8ì›” 31ì¼',
    bonus: 'ì½”ì¸ 2ë°°, ì—¬ë¦„ ì•„ë°”íƒ€',
    rewards: { coin_multiplier: 2.0, avatar_items: ['summer_hat', 'beach_shirt'] }
  },
  autumn: {
    name: 'ê°€ì„ ë…ì„œì˜ ê³„ì ˆ',
    duration: '9ì›” 1ì¼ ~ 11ì›” 30ì¼',
    bonus: 'ì—°ì† ë…ì„œ ë³´ë„ˆìŠ¤ ì¦ê°€',
    rewards: { streak_bonus: 2.0, special_quests: true }
  },
  winter: {
    name: 'ê²¨ìš¸ ë…ì„œ ë§ˆë¼í†¤',
    duration: '12ì›” 1ì¼ ~ 2ì›” 28ì¼',
    bonus: 'ì™„ë… ë³´ìƒ 3ë°°',
    rewards: { completion_multiplier: 3.0, winter_theme: true }
  }
}
```

#### ì£¼ê°„/ì›”ê°„ ì±Œë¦°ì§€

```javascript
const challenges = {
  weekly: {
    '7ì¼_ì—°ì†_ë…ì„œ': { xp: 200, coins: 100, badge: 'weekly_warrior' },
    'ì£¼ê°„_5ê¶Œ_ì™„ë…': { xp: 500, coins: 250, badge: 'speed_reader' },
    'ì£¼ê°„_10ì‹œê°„_ë…ì„œ': { xp: 300, coins: 150, badge: 'time_master' }
  },
  monthly: {
    'ì›”ê°„_20ê¶Œ_ì™„ë…': { xp: 2000, coins: 1000, badge: 'monthly_champion' },
    'ì›”ê°„_50ì‹œê°„_ë…ì„œ': { xp: 1500, coins: 750, badge: 'dedication_master' },
    'ì™„ë²½í•œ_í•œë‹¬': { xp: 3000, coins: 1500, badge: 'perfectionist' }
  }
}
```

### ğŸ… ë°°ì§€ ì‹œìŠ¤í…œ

#### ë°°ì§€ ì¹´í…Œê³ ë¦¬

```javascript
const badgeCategories = {
  progress: {
    name: 'ì§„í–‰ ë°°ì§€',
    badges: [
      { id: 'first_book', name: 'ì²« ì±…', condition: 'ì²« ì±… ë“±ë¡' },
      { id: 'book_collector', name: 'ìˆ˜ì§‘ê°€', condition: 'ì±… 50ê¶Œ ë“±ë¡' },
      { id: 'library_master', name: 'ë„ì„œê´€ì¥', condition: 'ì±… 200ê¶Œ ë“±ë¡' }
    ]
  },
  streak: {
    name: 'ì—°ì† ë°°ì§€',
    badges: [
      { id: 'week_streak', name: 'ì¼ì£¼ì¼ ì—°ì†', condition: '7ì¼ ì—°ì† ë…ì„œ' },
      { id: 'month_streak', name: 'í•œ ë‹¬ ì—°ì†', condition: '30ì¼ ì—°ì† ë…ì„œ' },
      { id: 'year_streak', name: 'ì¼ ë…„ ì—°ì†', condition: '365ì¼ ì—°ì† ë…ì„œ' }
    ]
  },
  achievement: {
    name: 'ì„±ì·¨ ë°°ì§€',
    badges: [
      { id: 'speed_reader', name: 'ì†ë…ì™•', condition: 'í•˜ë£¨ 5ê¶Œ ì™„ë…' },
      { id: 'night_owl', name: 'ì˜¬ë¹¼ë¯¸', condition: 'ë°¤ 12ì‹œ ì´í›„ ë…ì„œ' },
      { id: 'early_bird', name: 'ì¼ì° ì¼ì–´ë‚˜ëŠ” ìƒˆ', condition: 'ì˜¤ì „ 6ì‹œ ì´ì „ ë…ì„œ' }
    ]
  }
}
```

---

## êµ¬í˜„ ê°€ì´ë“œ

### ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

#### ì‚¬ìš©ì ë³´ìƒ í…Œì´ë¸”

```sql
-- ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ (users í…Œì´ë¸”ì— ì¶”ê°€)
ALTER TABLE users ADD COLUMN IF NOT EXISTS total_xp INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN IF NOT EXISTS total_coins INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN IF NOT EXISTS current_level INTEGER DEFAULT 1;
ALTER TABLE users ADD COLUMN IF NOT EXISTS current_streak INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN IF NOT EXISTS longest_streak INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN IF NOT EXISTS last_activity_date DATE;

-- ë³´ìƒ íˆìŠ¤í† ë¦¬ í…Œì´ë¸”
CREATE TABLE reward_history (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  reward_type VARCHAR(50) NOT NULL, -- 'quest', 'reading', 'streak', 'levelup'
  xp_amount INTEGER DEFAULT 0,
  coin_amount INTEGER DEFAULT 0,
  source_id UUID, -- quest_id, session_id ë“±
  multiplier DECIMAL(3,2) DEFAULT 1.0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ë ˆë²¨ì—… íˆìŠ¤í† ë¦¬ í…Œì´ë¸”
CREATE TABLE level_history (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  old_level INTEGER NOT NULL,
  new_level INTEGER NOT NULL,
  total_xp_at_levelup INTEGER NOT NULL,
  rewards_given JSONB, -- ë ˆë²¨ì—… ì‹œ ì§€ê¸‰ëœ ë³´ìƒ
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### ë°°ì§€ ì‹œìŠ¤í…œ í…Œì´ë¸”

```sql
-- ë°°ì§€ ì •ì˜ í…Œì´ë¸”
CREATE TABLE badges (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  description TEXT,
  icon_url VARCHAR(255),
  category VARCHAR(50), -- 'progress', 'streak', 'achievement', 'special'
  condition_type VARCHAR(50), -- 'books_read', 'days_streak', 'quests_completed'
  condition_value INTEGER,
  rarity VARCHAR(20) DEFAULT 'common', -- 'common', 'rare', 'epic', 'legendary'
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ì‚¬ìš©ì ë°°ì§€ í…Œì´ë¸”
CREATE TABLE user_badges (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  badge_id UUID REFERENCES badges(id) ON DELETE CASCADE,
  earned_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  progress INTEGER DEFAULT 0, -- ë°°ì§€ íšë“ ì§„í–‰ë¥ 
  UNIQUE(user_id, badge_id)
);
```

### ğŸš€ API ì—”ë“œí¬ì¸íŠ¸

#### ë³´ìƒ ì§€ê¸‰ API

```javascript
// POST /api/rewards/give
export async function POST(request) {
  const { userId, rewardType, sourceId, customAmount } = await request.json()
  
  try {
    const reward = await calculateReward(userId, rewardType, sourceId, customAmount)
    const result = await giveReward(userId, reward)
    
    return NextResponse.json({
      success: true,
      reward: result,
      newLevel: await getCurrentLevel(userId),
      leveledUp: result.leveledUp || false
    })
  } catch (error) {
    return NextResponse.json(
      { error: 'ë³´ìƒ ì§€ê¸‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

#### ì‚¬ìš©ì í†µê³„ API

```javascript
// GET /api/users/[userId]/stats
export async function GET(request, { params }) {
  try {
    const stats = await getUserStats(params.userId)
    const nextLevelXP = getXPToNextLevel(stats.total_xp)
    const recentRewards = await getRecentRewards(params.userId, 10)
    
    return NextResponse.json({
      success: true,
      stats: {
        ...stats,
        next_level_xp: nextLevelXP,
        level_progress: ((stats.total_xp % 100) / 100) * 100
      },
      recent_rewards: recentRewards
    })
  } catch (error) {
    return NextResponse.json(
      { error: 'í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    )
  }
}
```

### ğŸ® í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

#### ë³´ìƒ ì•Œë¦¼ ì»´í¬ë„ŒíŠ¸

```typescript
interface RewardNotificationProps {
  reward: {
    xp: number
    coins: number
    leveledUp?: boolean
    newLevel?: number
    badges?: string[]
  }
  onClose: () => void
}

export function RewardNotification({ reward, onClose }: RewardNotificationProps) {
  return (
    <div className="fixed top-4 right-4 bg-white rounded-lg shadow-lg p-6 z-50">
      <div className="flex items-center space-x-4">
        <div className="text-2xl">ğŸ‰</div>
        <div>
          <h3 className="font-semibold text-lg">ë³´ìƒ íšë“!</h3>
          <div className="flex items-center space-x-4 mt-2">
            {reward.xp > 0 && (
              <div className="flex items-center space-x-1">
                <Zap className="h-4 w-4 text-yellow-500" />
                <span className="font-medium">+{reward.xp} XP</span>
              </div>
            )}
            {reward.coins > 0 && (
              <div className="flex items-center space-x-1">
                <Coins className="h-4 w-4 text-amber-500" />
                <span className="font-medium">+{reward.coins} ì½”ì¸</span>
              </div>
            )}
          </div>
          {reward.leveledUp && (
            <div className="mt-2 text-blue-600 font-semibold">
              ğŸŠ ë ˆë²¨ {reward.newLevel} ë‹¬ì„±!
            </div>
          )}
        </div>
      </div>
    </div>
  )
}
```

---

## ë°¸ëŸ°ìŠ¤ ì¡°ì • ê°€ì´ë“œ

### ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ì§€í‘œ

#### í•µì‹¬ KPI

```javascript
const monitoringMetrics = {
  engagement: {
    daily_active_users: 'DAU ì¶”ì´',
    session_duration: 'í‰ê·  ì„¸ì…˜ ì‹œê°„',
    retention_rate: 'ì‚¬ìš©ì ìœ ì§€ìœ¨'
  },
  progression: {
    average_level: 'í‰ê·  ì‚¬ìš©ì ë ˆë²¨',
    level_distribution: 'ë ˆë²¨ë³„ ì‚¬ìš©ì ë¶„í¬',
    xp_per_session: 'ì„¸ì…˜ë‹¹ í‰ê·  XP'
  },
  economy: {
    coin_inflation: 'ì½”ì¸ ì¸í”Œë ˆì´ì…˜ìœ¨',
    spending_rate: 'ì½”ì¸ ì†Œë¹„ìœ¨',
    earning_rate: 'ì½”ì¸ íšë“ìœ¨'
  }
}
```

#### ë°¸ëŸ°ìŠ¤ ì¡°ì • ê¸°ì¤€

```javascript
const balanceThresholds = {
  // ë„ˆë¬´ ë¹ ë¥¸ ì§„í–‰
  too_fast: {
    level_per_day: 5, // í•˜ë£¨ 5ë ˆë²¨ ì´ìƒ
    xp_per_hour: 200, // ì‹œê°„ë‹¹ 200 XP ì´ìƒ
    coin_accumulation: 1000 // ì¼ì¼ 1000 ì½”ì¸ ì´ìƒ
  },
  
  // ë„ˆë¬´ ëŠë¦° ì§„í–‰
  too_slow: {
    level_per_week: 0.5, // ì£¼ë‹¹ 0.5ë ˆë²¨ ë¯¸ë§Œ
    xp_per_session: 10, // ì„¸ì…˜ë‹¹ 10 XP ë¯¸ë§Œ
    coin_per_day: 5 // ì¼ì¼ 5 ì½”ì¸ ë¯¸ë§Œ
  },
  
  // ì´ìƒì ì¸ ì§„í–‰
  optimal: {
    level_per_day: 1.5, // í•˜ë£¨ 1-2ë ˆë²¨
    xp_per_hour: 60, // ì‹œê°„ë‹¹ 60 XP
    coin_per_day: 50 // ì¼ì¼ 50 ì½”ì¸
  }
}
```

### ğŸ”§ ì¡°ì • ë°©ë²•

#### ë³´ìƒëŸ‰ ì¡°ì •

```javascript
// ë™ì  ë³´ìƒ ì¡°ì • ì‹œìŠ¤í…œ
const adjustRewards = (userStats, globalStats) => {
  let multiplier = 1.0
  
  // ì‹ ê·œ ì‚¬ìš©ì ë³´ë„ˆìŠ¤
  if (userStats.days_since_signup <= 7) {
    multiplier *= 1.5
  }
  
  // ë³µê·€ ì‚¬ìš©ì ë³´ë„ˆìŠ¤
  if (userStats.days_since_last_activity >= 7) {
    multiplier *= 2.0
  }
  
  // ê¸€ë¡œë²Œ ë°¸ëŸ°ìŠ¤ ì¡°ì •
  if (globalStats.average_progression > balanceThresholds.too_fast.level_per_day) {
    multiplier *= 0.8 // ë³´ìƒ ê°ì†Œ
  } else if (globalStats.average_progression < balanceThresholds.too_slow.level_per_day) {
    multiplier *= 1.2 // ë³´ìƒ ì¦ê°€
  }
  
  return Math.max(0.5, Math.min(3.0, multiplier)) // 0.5ë°°~3ë°° ì œí•œ
}
```

#### A/B í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬

```javascript
const abTestConfigs = {
  reward_amount: {
    control: { xp_multiplier: 1.0, coin_multiplier: 1.0 },
    variant_a: { xp_multiplier: 1.2, coin_multiplier: 0.8 },
    variant_b: { xp_multiplier: 0.8, coin_multiplier: 1.2 }
  },
  level_curve: {
    control: { xp_per_level: 100 },
    variant_a: { xp_per_level: 80 }, // ë” ë¹ ë¥¸ ë ˆë²¨ì—…
    variant_b: { xp_per_level: 120 } // ë” ëŠë¦° ë ˆë²¨ì—…
  }
}
```

---

## ê²°ë¡ 

BookCraftì˜ ë³´ìƒ ì‹œìŠ¤í…œì€ ì‚¬ìš©ìì˜ ë…ì„œ ë™ê¸°ë¥¼ ì§€ì†ì ìœ¼ë¡œ ìœ ì§€í•˜ë©´ì„œë„ ê³¼ë„í•˜ì§€ ì•Šì€ ì ì ˆí•œ ë³´ìƒì„ ì œê³µí•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì„œì˜ ê°€ì´ë“œë¼ì¸ì„ ë”°ë¼ êµ¬í˜„í•˜ê³ , ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ê³¼ ì¡°ì •ì„ í†µí•´ ìµœì ì˜ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í•µì‹¬ ì›ì¹™

1. **ì¦‰ì‹œ ë³´ìƒ**: ëª¨ë“  í™œë™ì— ì¦‰ê°ì ì¸ í”¼ë“œë°±
2. **ì¥ê¸° ì„±ì¥**: ë ˆë²¨ì—…ì„ í†µí•œ ì„±ì·¨ê°
3. **ê°œì¸í™”**: ë‹¤ì–‘í•œ ë³´ìƒ í™œìš© ë°©ì‹
4. **ê· í˜•**: ì ì ˆí•œ ë‚œì´ë„ì™€ ë³´ìƒ
5. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ìš©ì´ì„±

ì´ ì‹œìŠ¤í…œì„ í†µí•´ BookCraftëŠ” ë…ì„œë¥¼ ê²Œì„ì²˜ëŸ¼ ì¬ë¯¸ìˆê²Œ ë§Œë“¤ë©´ì„œë„ ì‹¤ì œ ë…ì„œ ìŠµê´€ í˜•ì„±ì— ë„ì›€ì´ ë˜ëŠ” í”Œë«í¼ìœ¼ë¡œ ë°œì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.